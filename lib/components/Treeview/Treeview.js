"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../_rollupPluginBabelHelpers-412799d7.js"),t=require("react");require("bootstrap/dist/css/bootstrap.min.css"),require("@fortawesome/react-fontawesome"),require("react-bootstrap");var r=require("../../hooks/useExpose.js"),n=require("../../deepMerge-c3f17a9c.js"),o=require("./TreeviewContext.js");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=a(t);var l=function e(t,r=new Map){if(null===t||"object"!=typeof t)return t;if(r.has(t))return r.get(t);const n=Array.isArray(t)?[]:{};r.set(t,n);for(const o in t)t.hasOwnProperty(o)&&(n[o]=e(t[o],r));return n},u=n.getDefaultExportFromCjs(l);var c=function e(t,r,n={},o=[]){const{idKey:a="key",childrenKey:i="children"}=n;return t.map((t=>{const l=[...o,t[a]],u=r(t,l,n)||t;return t[i]&&t[i].length>0&&(u[i]=e(t[i],r,n,l)),u}),{idKey:"name"})},d=n.getDefaultExportFromCjs(c);var f=function(e,t,r,n={}){const{idKey:o="key",childrenKey:a="children"}=n;"string"==typeof t&&(t=t.split("."));let i=e;for(const[e,n]of t.entries())"object"!=typeof i||Array.isArray(i)?"object"==typeof i&&Array.isArray(i)&&(i=i.find((e=>e?.[o]===n))):e===t.length-1?i[n]=r:i[n]?i=i[n]:i[a]&&i[a].find((e=>e?.[o]===n))?i=i[a].find((e=>e?.[o]===n)):i[n]=r;return e},s=n.getDefaultExportFromCjs(f);var p=function(e,t,r={}){const{defaultValue:n=null,idKey:o="key",childrenKey:a="children"}=r;"string"==typeof t&&(t=t.split("."));let i=e;for(const[e,r]of t.entries())if("object"!=typeof i||Array.isArray(i))"object"==typeof i&&Array.isArray(i)&&(i=i.find((e=>e?.[o]===r)));else if(i[r])i=i[r];else{if(!i[a])return n;i=i[a].find((e=>e?.[o]===r))}return i},y=n.getDefaultExportFromCjs(p),v=["children"];require("./style.css");var _=t.forwardRef((function(n,a){var l=n.name;n.title;var u=n.children;n.open,a=a||i.default.createRef(a);var c=t.useContext(o.default),d=c.options,f=c.data,s=c.toggleNode,p=t.useState({}),v=e._slicedToArray(p,2),_=v[0],h=v[1];r.default(a,{self:{}}),t.useEffect((function(){l||console.warn("TreeNode requires a name if you want to control it externally.")}),[]);return t.useEffect((function(){h(y(f,y(n,"_.path")))}),[f]),_&&i.default.createElement("div",{ref:a},d.model.Node(e._objectSpread2({},_),i.default.Children.map(u,(function(e,t){return i.default.cloneElement(e,{key:t})})),(function(){s(_._.path)}),_._&&_._.open))})),h=t.forwardRef((function(a,l){l=l||i.default.createRef(l);var c={model:{Node:function(e,t,r,n){return i.default.createElement("div",e,i.default.createElement("a",{onClick:r},n?"[-]":"[+]"),e.title,n&&t&&i.default.createElement("div",{style:{marginLeft:"20px"}},t))}}},f=t.useState((function(){return n.deepMerge(c,a.options||{})})),p=e._slicedToArray(f,2),h=p[0],g=p[1],m=t.useState(a.data||[]),j=e._slicedToArray(m,2),b=j[0],A=j[1],E=t.useState([]),S=e._slicedToArray(E,2),x=S[0],C=S[1],w=t.useState(),N=e._slicedToArray(w,2),q=N[0],k=N[1],K=function(t){return d(t,(function(t,r){return e._objectSpread2(e._objectSpread2({},t),{},{key:t.name,_:e._objectSpread2(e._objectSpread2({},t._),{},{level:r.length-1,path:r})})}),{idKey:"name"})},T=function t(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r.map((function(r){return i.default.createElement(_,e._extends({},r,{key:r.name,title:r.title||r.name,path:[r.key],level:n}),r.children&&t(r.children,n+1))}))},D=function t(r){return r&&0!==r.length?i.default.Children.map(r,(function(r){var n=r.props,o=n.children,a=e._objectWithoutProperties(n,v);return e._objectSpread2(e._objectSpread2({},a),{},{children:t(o)})})):[]},O=function(e,t){s(b,e,t),A(u(b))},P=function(t){"string"==typeof t&&(t=t.split(".")),t=[].concat(e._toConsumableArray(t),["_","open"]),s(b,t,!y(b,t)),A(u(b))};return r.default(l,{self:{options:h,setOptions:g,data:b,setData:A},writeNode:O,readNode:function(e){return y(b,e)},expandNode:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("toggle"==r)return P(t);if("string"==typeof t&&(t=t.split(".")),1==r)for(var n=0;n<t.length;n++){var o=t.slice(0,n+1);o=[].concat(e._toConsumableArray(o),["_","open"]),O(o,r)}else t=[].concat(e._toConsumableArray(t),["_","open"]),O(t,r)},toggleNode:P,expandAll:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if("toggle"==t){var r=!1;d(b,(function(e,t){e._.open||(r=!0)})),t=!!r}var n=d(b,(function(r,n){return e._objectSpread2(e._objectSpread2({},r),{},{_:e._objectSpread2(e._objectSpread2({},r._),{},{open:t})})}));A(u(n))}}),t.useEffect((function(){if(a.data&&a.data.length>0){var e=K(a.data);A(e),C(T(e))}else if(a.children){var t=D(a.children),r=K(t);A(r),C(T(r))}k(!0)}),[a.children,a.data]),q&&i.default.createElement("div",e._extends({ref:l},a),i.default.createElement(o.default.Provider,{value:{options:h,setOptions:g,data:b,setData:A,ready:q,toggleNode:P}},x))}));h.displayName="Treeview";var g=Object.assign(h,{Node:_});exports.default=g;

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../_rollupPluginBabelHelpers-412799d7.js"),t=require("react");require("bootstrap/dist/css/bootstrap.min.css");var r=require("react-bootstrap/Dropdown"),n=require("../../objects-c883ae06.js"),a=require("../../_commonjsHelpers-b3309d7b.js"),o=require("@ioutil/react/lib/hooks/useScreen"),l=require("@ioutil/react/lib//hooks/useExpose"),u=require("react-bootstrap"),c=require("./BranchdownContext.js"),i=require("./components/BranchdownItem.js"),d=require("./components/BranchdownButton.js");function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("react-bootstrap/DropdownButton");var f=s(t),p=s(r),m=s(o),h=s(l);function b(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var y=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=n.idKey,l=void 0===o?"key":o,u=n.childrenKey,c=void 0===u?"children":u;return t.map((function(t){var o=[].concat(b(a),[t[l]]),u=r(t,o,n)||t;return t[c]&&t[c].length>0&&(u[c]=e(t[c],r,n,o)),u}),{idKey:"name"})},v=a.getDefaultExportFromCjs(y);require("./Branchdown.css");var j=t.forwardRef((function(r,n){var a=r.title,o=r.children;n=n||f.default.createRef(n);var l=t.useContext(c.default),i=l.options,s=l.drawerExpanded,p=l.collapseDrawer,m=i.drawerProps;return f.default.createElement(u.Offcanvas,e._extends({show:s,onHide:p,ref:n},m,{className:"ioutil-branchdown-drawer ".concat(m.className||"")}),i.model.Drawer(a,f.default.createElement(d.default,{show:!0,title:"hidden",className:"ioutil-branchdown ".concat(m.className||"")},o)))})),_=t.forwardRef((function(r,a){a=a||f.default.createRef();var l={title:r.title,expand:r.expand||"sm",defaultMenuDrop:"end",drawerMenuDrop:"bottom",drawerProps:{style:{left:0,right:0},className:""},model:{Element:function(e){return f.default.createElement(f.default.Fragment,null,e.children?f.default.createElement(d.default,{title:e.key},e.children):f.default.createElement(p.default.Item,null,e.key))},Drawer:function(e,t){return f.default.createElement(f.default.Fragment,null,f.default.createElement(u.Offcanvas.Header,{closeButton:!0},f.default.createElement(u.Offcanvas.Title,null,e)),f.default.createElement(u.Offcanvas.Body,null,t))}}},i=t.useState((function(){return n.objects.deepMerge(l,r.options||{})})),s=e._slicedToArray(i,2),b=s[0],w=s[1],y=t.useState(v(r.data||[],(function(t,r){return e._objectSpread2(e._objectSpread2({},t),{},{_dropDownNodeInfo:e._objectSpread2(e._objectSpread2({},t._dropDownNodeInfo),{},{level:r.length-1,path:r})})}))),_=e._slicedToArray(y,2),E=_[0],S=_[1],g=t.useState([]),x=e._slicedToArray(g,2),D=x[0],q=x[1],A=m.default(),B=t.useState(!1),N=e._slicedToArray(B,2),O=N[0],k=N[1],I=t.useState(!1),T=e._slicedToArray(I,2),C=T[0],M=T[1],P=function(){return k(!1)},F=function(){return k(!0)};h.default(a,{self:{data:E,setData:S,options:b,setOptions:w},setTitle:function(t){w((function(r){return e._objectSpread2(e._objectSpread2({},r),{},{title:t})}))},title:b.title,collapseDrawer:P,expandDrawer:F,toggleDrawer:function(){return k((function(e){return!e}))}});var H=function t(r){return r?r.map((function(r,n){var a=Array.isArray(r.children)&&r.children.length>0;return f.default.createElement(f.default.Fragment,{key:n},b.model.Element(e._objectSpread2(e._objectSpread2({},r),{},{children:a?t(r.children):null})))})):null};return t.useEffect((function(){r.title||console.error("Branchdown requires a title prop.")}),[r]),t.useEffect((function(){A&&A.size&&M(!o.shouldExpand(A,b.expand))}),[A&&A.size]),t.useEffect((function(){r.data?q(H(r.data)):r.children&&q(r.children)}),[r.children,r.data]),f.default.createElement(c.default.Provider,{value:{options:b,setOptions:w,data:E,setData:S,collapseDrawer:P,drawerExpanded:O}},D&&!C&&f.default.createElement(d.default,e._extends({root:"true",onClick:function(){w((function(t){return e._objectSpread2(e._objectSpread2({},t),{},{behaviour:"default"})}))},ref:a},r,{title:b.title,className:"ioutil-branchdown ".concat(r.className||"")}),D),D&&C&&f.default.createElement(d.default,e._extends({root:"true",onClick:function(){F(),w((function(t){return e._objectSpread2(e._objectSpread2({},t),{},{behaviour:"drawer"})}))},ref:a},r,{title:b.title,className:"ioutil-branchdown ioutil-branchdown-hidemenu ".concat(r.className||"")})),f.default.createElement(j,{title:r.title},D))}));_.displayName="Branchdown";var E=Object.assign(_,{Button:d.default,Item:i.default,Context:c.default});exports.Branchdown=_,exports.default=E;
